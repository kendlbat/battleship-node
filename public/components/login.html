<script>
    document.querySelector("#loginComp-form").addEventListener("submit", () => {
        let gameid = document.querySelector("#gameid-input").value;
        window.x.APIHandler.joinGame(gameid)
            .then(() => {
                console.log("Game joined");
                window.x.loadComponent("components/waitScreen.html", document.querySelector("#componentContainer"));
            }).catch(() => console.error("Error while joining game"));
    });
    document.querySelector("#loginComp-create").addEventListener("click", () => {
        window.x.APIHandler.createGame().then(() => console.log("Game created"));
        window.x.loadComponent("components/waitScreen.html", document.querySelector("#componentContainer"));
    });

    if (typeof isLoginInputListenerSet == "undefined") {
        document.querySelector("#gameid-input").addEventListener("keydown", (e) => {
            let value = document.querySelector("#gameid-input").value;
            console.log(e);
            if (/^[a-zA-Z]$/g.test(e.key)) {
                e.preventDefault();
                e.stopPropagation();
                return;
            }
            if (value.length >= 6) {
                if (!value.includes("-") && e.key != "-" && e.key != "Backspace") {
                    document.querySelector("#gameid-input").value = value.substring(0, 6) + "-" + value.slice(6);
                }
            }
        });
        let isLoginInputListenerSet = true;
    }

    // Set focus to input
    document.querySelector("#gameid-input").focus();

    window.x.statusPoll = () => { return undefined };
</script>
<form action="javascript:void(0);" id="loginComp-form">
    <input type="text" name="gameid" id="gameid-input">
    <button type="button" id="loginComp-create">Create</button>
    <button type="submit" id="loginComp-join">Join</button>
</form>